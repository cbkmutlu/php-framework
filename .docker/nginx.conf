server {
   listen 80;
   server_name _;

   # Root directory
   root /var/www/html/Public;
   index index.php index.html;

   # Security headers
   add_header X-Frame-Options "SAMEORIGIN" always;
   add_header X-Content-Type-Options "nosniff" always;

   # Logging
   access_log /proc/self/fd/1;
   error_log  /proc/self/fd/2 warn;

   # Deny access to sensitive files
   location ~ /\. {
      deny all;
   }

   # Route all requests to index.php
   location / {
      try_files $uri $uri/ /index.php?$query_string;
   }

   # Cache
   location ~* \.(jpg|jpeg|png|gif|svg|ico|css|js|woff|woff2|ttf|eot)$ {
      expires 1M;
      access_log off;
      add_header Cache-Control "public";
   }

   # Disable cache for dynamic content
   location ~* \.(html|json)$ {
      expires -1;
      add_header Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate";
   }

   # PHP handling
   location ~ \.php($|/) {
      try_files $uri =404;
      fastcgi_split_path_info ^(.+\.php)(/.+)$;
      include fastcgi_params;
      fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
      fastcgi_param PATH_INFO $fastcgi_path_info;
      fastcgi_param DOCUMENT_ROOT $document_root;
      fastcgi_pass 127.0.0.1:9000;
   }

   # Gzip compression
   gzip on;
   gzip_disable "msie6";
   gzip_vary on;
   gzip_proxied any;
   gzip_comp_level 6;
   gzip_types text/plain text/css text/xml text/javascript application/javascript application/json application/xml application/xhtml+xml;
}
